{"version":3,"sources":["initializeScene.js","renderToCanvas.js","renderToSprite.js","MindMapNode.js","colors.js","colorsByLevel.js","renderMindCloud.js","addItem.jsx","App.js","index.js"],"names":["initializeScene","div","renderer","THREE","antialias","setSize","window","innerWidth","innerHeight","document","getElementById","appendChild","domElement","scene","add","camera","far","aspect","updateProjectionMatrix","loadImage","url","image","Image","Promise","resolve","onload","src","renderToCanvas","content","width","height","canvas","createElement","ctx","getContext","innerHTML","renderToStaticMarkup","drawImage","i","renderToSprite","map","material","sprite","scale","set","MindMapNode","level","label","xmlns","className","cx","magenta","violet","blue","turquoise","colors","all","data","nodes","node","name","then","Graph","ThreeForceGraph","graphData","nodeThreeObject","linkMaterial","color","colorsByLevel","linkWidth","lookAt","position","z","x","y","tbControls","TrackballControls","animate","tickFrame","update","render","requestAnimationFrame","AddItem","props","state","parent","org","person","handleChange","bind","saveFile","event","this","setState","target","value","e","preventDefault","parentNode","find","parentLink","links","link","source","id","orgId","length","nodeData","val","linkData","push","personId","personNodeData","personLinkData","addNodeData","addLinkData","placeholder","required","onChange","default","key","type","onClick","React","Component","App","divRef","createRef","useEffect","renderMindCloud","current","ref","rootElement","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.c54abfd8.chunk.js","sourcesContent":["import * as THREE from 'three';\n\nexport default function initializeScene(div) {\n\n  // Setup renderer\n  const renderer = new THREE.WebGLRenderer({ antialias: true });\n  renderer.setSize(window.innerWidth, window.innerHeight);\n  // div.appendChild(renderer.domElement);\n  document.getElementById('3d-graph').appendChild(renderer.domElement);\n\n  // Setup scene\n  const scene = new THREE.Scene();\n  scene.add(new THREE.AmbientLight(0xbbbbbb));\n\n  // Setup camera\n  const camera = new THREE.PerspectiveCamera();\n  camera.far = 10000;\n  camera.aspect = window.innerWidth/window.innerHeight;\n  camera.updateProjectionMatrix();\n\n  return { scene, renderer, camera };\n}\n","import { renderToStaticMarkup } from 'react-dom/server';\n\nfunction loadImage(url) {\n  const image = new window.Image();\n  return new Promise((resolve) => {\n    image.onload = () => resolve(image);\n    image.src = url;\n  });\n}\n\nexport default async function renderToCanvas(content, { width, height }) {\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  const ctx = canvas.getContext('2d');\n  const url = `data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${width}\" height=\"${height}\">\n      <style type=\"text/css\">\n        <![CDATA[\n          ${document.getElementById('styles').innerHTML}\n        ]]>\n      </style>\n      <foreignObject width=\"${width}\" height=\"${height}\">\n      ${renderToStaticMarkup(content)}\n      </foreignObject>\n      </svg>`;\n  const image = await loadImage(url);\n  ctx.drawImage(image, 0, 30);\n  return canvas;\n}\n","import * as THREE from 'three';\nimport renderToCanvas from './renderToCanvas';\n\nexport default async function renderToSprite(content, { width, height }) {\n  const canvas = await renderToCanvas(content, {\n    width,\n    height\n  });\n  const map = new THREE.CanvasTexture(canvas);\n  const material = new THREE.SpriteMaterial({ map });\n  const sprite = new THREE.Sprite(material);\n  sprite.scale.set(width / 6, height / 6);\n  return sprite;\n}\n","import React from 'react';\nimport cx from 'classnames';\n\nexport default function MindMapNode({ level, label }) {\n  return (\n    <div\n      xmlns=\"http://www.w3.org/1999/xhtml\"\n      className={cx(\n        'mind-map-node',\n        level === 0 && 'magenta',\n        level === 1 && 'violet',\n        level === 2 && 'blue',\n        level >= 3 && 'turquoise'\n      )}\n    >\n      <div>{label}</div>\n    </div>\n  );\n}\n","import * as THREE from 'three';\n\nexport default {\n  magenta: new THREE.Color(0xf103c8),\n  violet: new THREE.Color(0x8603f1),\n  blue: new THREE.Color(0x0064d2),\n  turquoise: new THREE.Color(0x0064d2)\n};\n","import colors from './colors';\n\nexport default [colors.magenta, colors.violet, colors.blue, colors.turquoise];\n","import React from 'react';\nimport data from './data';\nimport initializeScene from './initializeScene';\nimport ThreeForceGraph from 'three-forcegraph';\nimport renderToSprite from './renderToSprite';\nimport MindMapNode from './MindMapNode';\nimport { TrackballControls } from 'three/examples/jsm/controls/TrackballControls.js';\nimport * as THREE from 'three';\nimport colorsByLevel from './colorsByLevel';\n\n\nexport default async function renderMindCloud(div) {\n    // adapted from @pahund https://dev.to/pahund/drawing-a-mind-map-with-three-js-and-react-force-directed-graphs-nuffshell-coding-diary-part-iv-1b74\n\n    const { scene, renderer, camera } = initializeScene(div, data);\n\n    // Create labels \n    data.nodes = await Promise.all(\n        data.nodes.map((node) =>\n            renderToSprite(<MindMapNode label={node.name} level={node.level} />, {\n            width: 120,\n            height: 200\n            }).then((sprite) => ({ ...node, sprite }))\n        )\n    );\n\n    // Add data\n    const Graph = new ThreeForceGraph()\n    .graphData(data);\n\n    // Draw labels\n    Graph.nodeThreeObject(({ sprite }) => sprite );\n    Graph.linkMaterial(\n        ({ level }) => new THREE.MeshBasicMaterial({ color: colorsByLevel[level] })\n      );\n    Graph.linkWidth(1);\n    scene.add(Graph);\n\n    // const N = 300;\n    // camera.lookAt(Graph.position);\n    // camera.position.z = Math.cbrt(N) * 180;\n\n    camera.lookAt(Graph.position);\n    camera.position.z = -300\n    camera.position.x = -220\n    camera.position.y = -100\n    \n    // Add camera controls\n    const tbControls = new TrackballControls(camera, renderer.domElement);\n\n    // Kick-off renderer\n    (function animate() { // IIFE\n        Graph.tickFrame();\n\n        // Frame cycle\n        tbControls.update();\n        renderer.render(scene, camera);\n        requestAnimationFrame(animate);\n    })();\n}","import React from 'react';\nimport data from './data';\n\n// function AddItem() {\nclass AddItem extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            parent: '',\n            org: '' ,\n            person: '' ,\n            add: '' ,\n        };\n    \n        this.handleChange = this.handleChange.bind(this);\n        this.saveFile = this.saveFile.bind(this);\n    }\n    \n    handleChange(event) {\n        this.setState({ [event.target.name] : event.target.value});\n    }\n\n    saveFile(e){\n        e.preventDefault();\n\n        const parent = this.state.parent\n        const org = this.state.org\n        const person = this.state.person\n        const add = this.state.add\n\n        // org\n        const parentNode = data.nodes.find((node) => node.name == parent)\n        if (parentNode) {\n            const parentLink = data.links.find((link) => link.source.id == parentNode.id)\n            const orgId = data.nodes.length + 1\n\n            const nodeData = {  \"id\": orgId,\n                            \"name\": org,\n                            \"val\": parentNode.val = 1 ? 1 : parentNode.val - 1,\n                            \"level\": parentNode.level + 1}\n            const linkData = {\n                                \"source\": parentNode.id,\n                                \"target\": orgId,\n                                \"level\": parentLink.level + 1\n                            }\n            data.nodes.push(nodeData)\n            data.links.push(linkData)\n\n            // person\n            const personId = orgId + 1\n            const personNodeData = {  \"id\": personId,\n                            \"name\": person,\n                            \"val\": nodeData.val = 1 ? 1 : nodeData.val - 1,\n                            \"level\": orgId.level + 1}\n            const personLinkData = {\n                                \"source\": orgId.id,\n                                \"target\": personId,\n                                \"level\": orgId.level + 1\n                            }\n            data.nodes.push(personNodeData)\n            data.links.push(personLinkData)\n\n            // additional\n\n            if (add) {\n                const addNodeData = {  \"id\": personId + 1,\n                    \"name\": parent,\n                    \"val\": personNodeData.val = 1 ? 1 : personNodeData.val - 1,\n                    \"level\": personId.level + 1}\n            \n                const addLinkData = {\n                    \"source\": personId.id,\n                    \"target\": personId + 1,\n                    \"level\": personId.level + 1\n                }\n                data.nodes.push(addNodeData)\n                data.links.push(addLinkData)\n            }\n        }\n    }\n\n    render() {  \n        return(\n            <div className=\"col-lg-4 col-md-4 col-sm-4\">\n                <form id=\"formdata\">\n                <label>Parent Item on Graph</label>\n                        <select id=\"parent\" name=\"parent\" placeholder=\"Parent Item on Graph\" required onChange={this.handleChange}>\n                            <option value=\"\" default>Select one</option>\n                            {data.nodes.map((node) => {\n                                return <option name={node.name} key={node.id}>{node.name}</option>\n                            })}\n                        </select>\n                    <input id=\"org\" name=\"org\" type=\"text\" placeholder=\"New item\" required onChange={this.handleChange}/>\n                    <input id=\"person\" name=\"person\" type=\"text\" placeholder=\"Sub-item\" required onChange={this.handleChange}/>\n                    <input id=\"add\" name=\"add\" type=\"text\" placeholder=\"Additional item (optional)\" onChange={this.handleChange}/>\n                    <input type=\"button\" id=\"bt\" value=\"save\" onClick={this.saveFile} />\n                </form>\n            </div>\n        )\n    };\n}\n\nexport default AddItem;\n","import React, { createRef, useEffect } from 'react';\nimport renderMindCloud from './renderMindCloud';\nimport AddItem from './addItem'\n\nexport default function App() {\n  const divRef = createRef();\n  useEffect(() => renderMindCloud(divRef.current), [divRef]);\n  return <div ref={divRef} >\n    <AddItem/>\n    </div>;\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  rootElement\n);\n"],"sourceRoot":""}