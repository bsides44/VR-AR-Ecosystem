{"version":3,"sources":["initializeScene.js","renderToCanvas.js","renderToSprite.js","MindMapNode.js","colors.js","colorsByLevel.js","renderMindCloud.js","addItem.jsx","App.js","index.js"],"names":["initializeScene","div","renderer","THREE","antialias","setSize","window","innerWidth","innerHeight","appendChild","domElement","scene","add","camera","far","aspect","updateProjectionMatrix","loadImage","url","image","Image","Promise","resolve","onload","src","renderToCanvas","content","width","height","canvas","document","createElement","ctx","getContext","getElementById","innerHTML","renderToStaticMarkup","drawImage","i","renderToSprite","map","material","sprite","scale","set","MindMapNode","level","label","xmlns","className","cx","magenta","violet","blue","turquoise","colors","addData","dataVar","all","nodes","node","name","then","Graph","ThreeForceGraph","graphData","nodeThreeObject","linkMaterial","color","colorsByLevel","linkWidth","lookAt","position","z","x","y","tbControls","TrackballControls","animate","tickFrame","update","render","requestAnimationFrame","fetch","response","json","dataJson","AddItem","props","state","parent","org","person","data","handleChange","bind","saveFile","setState","event","this","target","value","e","preventDefault","parentNode","find","parentLink","links","link","source","id","orgId","length","nodeData","val","linkData","Number","push","personId","personNodeData","personLinkData","addNodeData","addLinkData","placeholder","required","onChange","default","key","type","onClick","React","Component","App","divRef","createRef","useEffect","renderMindCloud","current","ref","rootElement","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.2d0a903b.chunk.js","sourcesContent":["import * as THREE from 'three';\n\nexport default function initializeScene(div) {\n\n  // Setup renderer\n  const renderer = new THREE.WebGLRenderer({ antialias: true });\n  renderer.setSize(window.innerWidth, window.innerHeight);\n  div.appendChild(renderer.domElement);\n\n  // Setup scene\n  const scene = new THREE.Scene();\n  scene.add(new THREE.AmbientLight(0xbbbbbb));\n\n  // Setup camera\n  const camera = new THREE.PerspectiveCamera();\n  camera.far = 10000;\n  camera.aspect = window.innerWidth/window.innerHeight;\n  camera.updateProjectionMatrix();\n\n  return { scene, renderer, camera };\n}\n","import { renderToStaticMarkup } from 'react-dom/server';\n\nfunction loadImage(url) {\n  const image = new window.Image();\n  return new Promise((resolve) => {\n    image.onload = () => resolve(image);\n    image.src = url;\n  });\n}\n\nexport default async function renderToCanvas(content, { width, height }) {\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  const ctx = canvas.getContext('2d');\n  const url = `data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${width}\" height=\"${height}\">\n      <style type=\"text/css\">\n        <![CDATA[\n          ${document.getElementById('styles').innerHTML}\n        ]]>\n      </style>\n      <foreignObject width=\"${width}\" height=\"${height}\">\n      ${renderToStaticMarkup(content)}\n      </foreignObject>\n      </svg>`;\n  const image = await loadImage(url);\n  ctx.drawImage(image, 0, 30);\n  return canvas;\n}\n","import * as THREE from 'three';\nimport renderToCanvas from './renderToCanvas';\n\nexport default async function renderToSprite(content, { width, height }) {\n  const canvas = await renderToCanvas(content, {\n    width,\n    height\n  });\n  const map = new THREE.CanvasTexture(canvas);\n  const material = new THREE.SpriteMaterial({ map });\n  const sprite = new THREE.Sprite(material);\n  sprite.scale.set(width / 6, height / 6);\n  return sprite;\n}\n","import React from 'react';\nimport cx from 'classnames';\n\nexport default function MindMapNode({ level, label }) {\n  return (\n    <div\n      xmlns=\"http://www.w3.org/1999/xhtml\"\n      className={cx(\n        'mind-map-node',\n        level === 0 && 'magenta',\n        level === 1 && 'violet',\n        level === 2 && 'blue',\n        level >= 3 && 'turquoise'\n      )}\n    >\n      <div>{label}</div>\n    </div>\n  );\n}\n","import * as THREE from 'three';\n\nexport default {\n  magenta: new THREE.Color(0xf103c8),\n  violet: new THREE.Color(0x8603f1),\n  blue: new THREE.Color(0x0064d2),\n  turquoise: new THREE.Color(0x0064d2)\n};\n","import colors from './colors';\n\nexport default [colors.magenta, colors.violet, colors.blue, colors.turquoise];\n","import React from 'react';\nimport initializeScene from './initializeScene';\nimport ThreeForceGraph from 'three-forcegraph';\nimport renderToSprite from './renderToSprite';\nimport MindMapNode from './MindMapNode';\nimport { TrackballControls } from 'three/examples/jsm/controls/TrackballControls.js';\nimport * as THREE from 'three';\nimport colorsByLevel from './colorsByLevel';\n\nexport default async function renderMindCloud(div) {\n    // adapted from @pahund https://dev.to/pahund/drawing-a-mind-map-with-three-js-and-react-force-directed-graphs-nuffshell-coding-diary-part-iv-1b74\n\n    // Get data\n    window.fetch('data.json').then(response => {\n            response.json().then(dataJson => {\n                addData(dataJson)\n            })\n        })\n    \n    async function addData(dataVar){\n        const { scene, renderer, camera } = initializeScene(div, dataVar);\n\n        // Create labels \n        dataVar.nodes = await Promise.all(\n            dataVar.nodes.map((node) =>\n                renderToSprite(<MindMapNode label={node.name} level={node.level} />, {\n                width: 120,\n                height: 200\n                }).then((sprite) => ({ ...node, sprite }))\n            )\n        );\n\n        // Create graoh from data\n        const Graph = new ThreeForceGraph()\n        .graphData(dataVar);\n            \n\n        // Draw labels\n        Graph.nodeThreeObject(({ sprite }) => sprite );\n        Graph.linkMaterial(\n            ({ level }) => new THREE.MeshBasicMaterial({ color: colorsByLevel[level] })\n        );\n        Graph.linkWidth(1);\n        scene.add(Graph);\n\n        // const N = 300;\n        // camera.lookAt(Graph.position);\n        // camera.position.z = Math.cbrt(N) * 180;\n\n        camera.lookAt(Graph.position);\n        camera.position.z = -300\n        camera.position.x = -220\n        camera.position.y = -100\n        \n        // Add camera controls\n        const tbControls = new TrackballControls(camera, renderer.domElement);\n\n        // Kick-off renderer\n        (function animate() { // IIFE\n            Graph.tickFrame();\n\n            // Frame cycle\n            tbControls.update();\n            renderer.render(scene, camera);\n            requestAnimationFrame(animate);\n        })();\n    }\n}","import React from 'react';\n// import data from './data';\n\n// function AddItem() {\nclass AddItem extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            parent: '',\n            org: '' ,\n            person: '' ,\n            add: '' ,\n            data: null\n        };\n    \n        this.handleChange = this.handleChange.bind(this);\n        this.saveFile = this.saveFile.bind(this);\n    }\n\n    componentDidMount() {\n        fetch('data.json').then(response => {\n            response.json().then(dataJson => {\n                this.setState({data: dataJson});\n            })\n        })            \n    }\n\n    \n    handleChange(event) {\n        this.setState({ [event.target.name] : event.target.value});\n    }\n\n    saveFile(e){\n        e.preventDefault();\n\n        const parent = this.state.parent\n        const org = this.state.org\n        const person = this.state.person\n        const add = this.state.add\n        const data = this.state.data\n\n        // org\n        const parentNode = data.nodes.find((node) => node.name === parent)\n\n        if (parentNode) {\n            const parentLink = data.links.find((link) => link.source.id === parentNode.id)\n            const orgId = data.nodes.length + 1\n\n            const nodeData = {  \"id\": orgId,\n                            \"name\": org,\n                            \"val\": parentNode.val <= 1 ? 1 : parentNode.val - 1,\n                            \"level\": parentNode.level + 1}\n            const linkData = {\n                            \"source\": Number(parentNode.id),\n                            \"target\": orgId,\n                            \"level\": parentLink ? parentLink.level + 1 : 3\n                            }\n            data.nodes.push(nodeData)\n            data.links.push(linkData)\n\n            // person\n            const personId = orgId + 1\n            const personNodeData = {  \"id\": personId,\n                            \"name\": person,\n                            \"val\": nodeData.val <= 1 ? 1 : nodeData.val - 1,\n                            \"level\": nodeData.level + 1}\n            const personLinkData = {\n                            \"source\": nodeData.id,\n                            \"target\": personId,\n                            \"level\": linkData ? linkData.level + 1 : 3\n                            }\n            data.nodes.push(personNodeData)\n            data.links.push(personLinkData)\n\n            // additional\n            if (add) {\n                const addNodeData = {  \"id\": personId + 1,\n                    \"name\": add,\n                    \"val\": personNodeData.val = 1 ? 1 : personNodeData.val - 1,\n                    \"level\": personNodeData.level + 1\n                }\n            \n                const addLinkData = {\n                    \"source\": personNodeData.id,\n                    \"target\": personId + 1,\n                    \"level\": personNodeData ? personNodeData.level + 1 : 3\n                }\n                data.nodes.push(addNodeData)\n                data.links.push(addLinkData)\n            }\n        }\n\n\n\n    }\n\n    render() {  \n        return(\n            <div className=\"col-lg-4 col-md-4 col-sm-4\">\n                <form id=\"formdata\">\n                <label>Parent Item on Graph</label>\n                        <select id=\"parent\" name=\"parent\" placeholder=\"Parent Item on Graph\" required onChange={this.handleChange}>\n                            <option value=\"\" default>Select one</option>\n                            {this.state.data ? this.state.data.nodes.map((node) => {\n                                return <option name={node.name} key={node.id}>{node.name}</option>\n                            }) : null}\n                        </select>\n                    <input id=\"org\" name=\"org\" type=\"text\" placeholder=\"New item\" required onChange={this.handleChange}/>\n                    <input id=\"person\" name=\"person\" type=\"text\" placeholder=\"Sub-item\" required onChange={this.handleChange}/>\n                    <input id=\"add\" name=\"add\" type=\"text\" placeholder=\"Additional item (optional)\" onChange={this.handleChange}/>\n                    <input type=\"button\" id=\"bt\" value=\"save\" onClick={this.saveFile} />\n                </form>\n            </div>\n        )\n    };\n}\n\nexport default AddItem;\n","import React, { createRef, useEffect } from 'react';\nimport renderMindCloud from './renderMindCloud';\nimport AddItem from './addItem'\n\nexport default function App() {\n  const divRef = createRef();\n  useEffect(() => renderMindCloud(divRef.current), [divRef]);\n  return <div ref={divRef} >\n    <AddItem/>\n    </div>;\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  rootElement\n);\n"],"sourceRoot":""}